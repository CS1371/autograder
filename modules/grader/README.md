# Grader

This module handles the actual "grading" of the students. It has no functions directly; only classes (but these classes have methods).

## Functions

The `grader` module has the following functions:

- `[string html] = generateFeedback(var studentSubmission, var solnSubmission);`

Generate feedback for the given submissions. This is only for _primitives_ - values that are "built in" to MATLAB. `var` can be any of the following:

- `char`
- `cell`
- `numeric` (`double`, `float`, `int*`, `uint*`, etc.)
- `string`
- `struct`

## Classes

The `grader` module has the following classes:

### `Student`

Represents a single student in the grader.

Has the following fields:

- `name`: The name of the student
- `id`: The ID of the student
- `path`: The fully qualified path for this student's directory
- `submissions`: A string array of file names that represent all names of submitted files
- `feedbacks`: A cell array of `Feedback` arrays. Each cell in feedbacks is a `Feedback` array representing all test cases for a specific problem
- `isGraded`: A logical stating if a student object has been graded

Has the following methods:

- `void gradeProblem(Problem)` - Grades the given problem (copying over the TestCases) and records the results. Does *not* write the HTML feedback
- `string generateResponse()` - Generates complete HTML markup for this student

### `Problem`

Represents a single problem set

Has the following fields:

- `name`: The name of the problem (function name without `.m`)
- `testCases`: An array of `TestCase` for this problem
- `banned`: A cell array of names of banned functions for this problem
- `isRecursive`: A logical; `true` if the function must be recursive to receive credit.

### `TestCase` class

A single test case for a given problem

Has the following fields:

- `call`: The complete function call (i.e., `[out1, out2] = myFunction(in1, in2);`)
- `initializer`: The complete function call for a function to be run immediately before testing the student's code.
  - This is useful if a variable's value cannot be determined until right before the function call.
  - Each output's name must exactly match the name of an input.
  - The values for the outputs overwrite the value for its corresponding input.
  - For example, suppose `inputs` looked like this:
    - `struct('fid', 0, 'outputName', 'helloWorld.txt');`
  - And suppose you wanted to populate `fid` with a valid file handle. In that case, your `initializer` would look like:
    - `[fid] = fopen('myInput.txt');`
  - Now suppose fid is now 3. This will _overwrite_ the previous value of `fid` (0) found in `inputs`.
  - If you want a custom function to run instead, include it as a supporting file and call it.
- `points`: The points possible for this specific test case
- `supportingFiles`: A string array of complete file paths that will need to be copied to the student's directory
- `loadFiles`: A string array of complete file paths of MAT files to load
- `banned`: A string array of names of banned functions for this problem
- `path`: The fully qualified path to the solution code directory
- `outputs`: A structure where the field name is the name of the output, and the field value is the value of the output
- `files`: A `File` array that represents all the files produced as outputs
- `plots`: A `Plot` array that represents the data about all the plots generated

### `Feedback`

Represents feedback for a specific `TestCase`

- `testCase`: The `TestCase` for this feedback
- `problem`: The problem name for this feedback
- `isPassed`: True if the student passed this test completely
- `path`: The fully qualified path for this student's directory
- `outputs`: The outputs produced by the student
- `files`: A `File` array that represents all the files produced by the student
- `plots`: A `Plot` array that represents all the plots generated by the student
- `points`: The number of points earned for this test case
- `exception`: The exception thrown by the user - empty if no exception occurred.

### `File`

This class helps in storing and comparing files. It has the following fields:

- `name`: The filename for this file, without the extension
- `extension`: The file extension
- `data`: One of the following:
  - Image: `MxNx3 uint8`
  - Text: String array of lines (without newline character)
  - Excel: Cell array for raw output

And has the following methods:

- `[bool isEqual, string message] = equals(File other)`: Checks if the given file is considered equal to this file, which means:
  - Names are the same
  - Extensions are the same
  - Data is the same
  - If `isEqual` is `false`, `message` contains a reason they aren't equal
- `[string HTML] = generateFeedback(File solution)`: Generates HTML feedback that will be shown to the student. Note that the input is the solution's File.
  - If the File is text, it shows a `visdiff` of the two files (as produced by MATLAB)
  - If the File is an image, it will use the default Image Comparison tool.
  - If the File is an Excel file, it will convert the cell array into a "table", and then use `visdiff` to compare.

### `Plot`

This class contains all pertinent data for a plot.

It has the following fields:

- `Title`: The title used for the plot
- `XData`: A cell array of vectors that represents all `XData` points plotted for this plot
- `YData`: A cell array of vectors that represents all `YData` points plotted for this plot
- `ZData`: A cell array of vectors that represents all `ZData` points plotted for this plot
- `Position`: Where the plot is relative to the window. A vector; used to determine subplotting
- `PlotBox`: A string used to see the orientation of the `axes`
- `Image`: An image taken of the plot, as an `MxNx3 uint8` array.
- `Legend`: A string array of all the names in the legend
- `Color`: A string array that represents the color used for every line
- `Marker`: A cell array of the point markers used, where each entry is a string
- `LineStyle`: A cell array of the line styles used, where each entry is a string

It has the following methods:

- `[bool isEqual, string message] = equals(Plot other)`: Checks if the given plot is considered equal to this plot.

If `isEqual` is `false`, `message` contains a reason they aren't equal

- `[string HTML] = generateFeedback(Plot solution)`: Generates HTML feedback for the two plots (where the input plot is the solution plot)
