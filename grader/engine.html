
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>engine: Main Engine of the Autograder</title><meta name="generator" content="MATLAB 9.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script><script>
      $(document).ready(function() {
        // get name of class
        // anywhere CLASS name is or METHOD name is, replace with code version
        // class name will be in only h1
        // methods will be underneath ul that says Methods as text (I know, hacky...)
        var cName = $('h1').text();
        cName = cName.split(':');
        cName = cName[0];
        var strNewString = $('body').html().replace(new RegExp('\\s+' + cName + '\\s+', "g"),'&nbsp;<code>Student</code>&nbsp;');
        $('body').html(strNewString);

        // for each occurrence of this in 
      });
    </script><meta name="DC.date" content="2018-06-20"><meta name="DC.source" content="engine.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
code { font-size: 1.2em; before: " " }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="container-fluid"><div class="content"><h1>engine: Main Engine of the Autograder</h1><!--introduction--><p>The engine function serves as the primary runner of code.</p><p>T = engine(T) runs the code specified by the TestCase T, and assigns the outputs, files, and plots to the corresponding fields in T. The output is the same size as the input</p><p>F = engine(F) runs the code specified by the TestCase found in Feedback F, and assigns the outputs, files, and plots to the corresponding fields in F. This does NOT grade the code, just runs it. You must capture the outputs; the engine does NOT modify the inputs. The output is the same size as the inputs</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Remarks</a></li><li><a href="#2">Exceptions</a></li><li><a href="#3">Unit Tests</a></li><li><a href="#5">Setup</a></li><li><a href="#7">parseFunction: Parse function call</a></li><li><a href="#8">Remarks</a></li><li><a href="#9">Unit Tests</a></li></ul></div><h2 id="1">Remarks</h2><p>For multiple runnables, the engine will wait until all of them have finished, or timed out. However, other than that, there is no requirement that any of them be related to each other - they are all run in parallel.</p><p>while it will always be faster to run runnables in parallel, there are no guarantees about timing or order. If you need a specific order, you must run them individually.</p><p>The engine function is the primary grading mechanism used within the the autograder. It provides a "sandboxed" environment for running code, and protects against student errors and timeouts.</p><p>The student's code is copied to a new folder, and all supporting files are also copied over. It is guaranteed that, though the students are run in parallel, no student's code can ever affect another student's code.</p><p>Timeouts are handled using a parallel pool of workers. In essence, a student's code is limited to a certain runtime, 30 seconds by default. To change this value, you should edit the TIMEOUT field of the STudent class.</p><p>Errors in the code itself are handled differently, depending on whether a TestCase or a Feedback was passed in.</p><p>If a TestCase was received, the error is propogated; this is because a solution error is usually a fatal error.</p><p>If a Feedback was received, the error is caught and assigned to the exception field of the Feedback.</p><p>engine uses static checking to check if the function is recursive. Calls are traced to the first instance of a call to a built in function. For each call to a user-supplied function, that function is checked to see if it ever calls itself or anything up the stack. Mutual Recursion is checked. Note that it's possible to circumvent this checking by having the recursive call within an if statement, like so:</p><pre class="language-matlab"><span class="keyword">function</span> notRecurse()
    <span class="keyword">if</span> false
        notRecurse();
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><p>engine cannot tell that this isn't actually recursive, since it's not known until runtime that if false will never actually be true.</p><p>Additionally, banned function usage is also statically checked. Calls are traced to the first instance of a call to a built in function, just like checking for recursion. Each call to a user-defined function results in a check for use of banned functions. Note that, just as with recursion checking, a "false positive" is possible if code that is unreachable uses a banned function.</p><pre class="language-matlab"><span class="keyword">function</span> notBanned()
    <span class="keyword">if</span> false
        bannedFunction();
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><p>Note that for both recursion and banned functions, comments do not count.</p><p>If user created their own version of a banned function, and included it in the file, then that is considered to be OK.</p><p>Even if the student uses a banned function, the code is still run, and outputs still produced.</p><h2 id="2">Exceptions</h2><p>An AUTOGRADER:engine:invalidRunnable exception is thrown if the input is in an invalid state.</p><p>An AUTOGRADER:engine:invalidSolution exception is thrown if the input is a solution AND that solution errors. The original exception is added to the causes array of the MException.</p><p>A TIMEOUT exception will never be thrown, but will be assigned to the Feedback's exception field instead, should the code timeout.</p><h2 id="3">Unit Tests</h2><pre class="language-matlab"><span class="comment">% Assume T is a valid TestCase that does NOT error.</span>
T = TestCase(<span class="keyword">...</span><span class="comment">);</span>
engine(T);
</pre><pre class="language-matlab">T <span class="string">now</span> <span class="string">has</span> <span class="string">files</span>, outputs, etc. filled in <span class="string">correctly</span>
</pre><pre class="language-matlab"><span class="comment">% Assume T is a valid TestCase that errors</span>
T = TestCase(<span class="keyword">...</span><span class="comment">);</span>
engine(T);
</pre><pre class="language-matlab">Threw <span class="string">exception</span> <span class="string">invalidSolution</span>, with <span class="string">the</span> <span class="string">original</span> <span class="string">error</span>
in <span class="string">causes.</span>
</pre><pre class="language-matlab"><span class="comment">% Assume T has not been correctly initialized</span>
T;
engine(T);
</pre><pre class="language-matlab">Threw <span class="string">exception</span> <span class="string">invalidRunnable</span>
</pre><pre class="language-matlab"><span class="comment">% Assume F is a valid Feedback with a valid TestCase</span>
F = Feedback(<span class="keyword">...</span><span class="comment">);</span>
engine(F);
</pre><pre class="language-matlab">F <span class="string">now</span> <span class="string">has</span> <span class="string">files</span>, outputs, etc. filled in <span class="string">correctly</span>
</pre><pre class="language-matlab"><span class="comment">% Assume F is a valid Feedback that errors</span>
F = Feedback(<span class="keyword">...</span><span class="comment">);</span>
engine(F);
</pre><pre class="language-matlab">F <span class="string">will</span> <span class="string">have</span> <span class="string">no</span> <span class="string">fields</span> <span class="string">filled</span> <span class="string">in</span> <span class="string">except</span> <span class="string">for</span> <span class="string">points</span> <span class="string">(0)</span> <span class="string">and</span> <span class="string">exception</span>,
which <span class="string">will</span> <span class="string">be</span> <span class="string">the</span> <span class="string">exception</span> <span class="string">raised</span> <span class="string">by</span> <span class="string">the</span> <span class="string">student</span> <span class="string">code.</span>
</pre><pre class="language-matlab"><span class="comment">% Assume F is a valid Feedback that goes into an infinite loop</span>
F = Feedback(<span class="keyword">...</span><span class="comment">);</span>
engine(F);
</pre><pre class="language-matlab">F <span class="string">will</span> <span class="string">have</span> <span class="string">no</span> <span class="string">fields</span> <span class="string">filled</span> <span class="string">in</span> <span class="string">except</span> <span class="string">for</span> <span class="string">points</span> <span class="string">(0)</span> <span class="string">and</span> <span class="string">exception</span>,
which <span class="string">will</span> <span class="string">be</span> <span class="string">the</span> <span class="string">timeout</span> <span class="string">exception.</span>
</pre><pre class="language-matlab"><span class="comment">% Assume F is an invalid Feedback;</span>
F;
engine(F);
</pre><pre class="language-matlab">Threw <span class="string">exception</span> <span class="string">invalidRunnable</span>
</pre><pre class="language-matlab">F = []; <span class="comment">% assume F is a vector of Feedbacks</span>
A = engine(F);
</pre><pre class="language-matlab">A <span class="string">is</span> <span class="string">a</span> <span class="string">vector</span> <span class="string">of</span> <span class="string">finished</span> <span class="string">runnables.</span>
</pre><h2 id="5">Setup</h2><h2 id="7">parseFunction: Parse function call</h2><p>Parses the function call for inputs, outputs, and the function handle.</p><p>[I, O, F] = parseFunction(C) will parse the function call C and return the input names in I, the output names in O, and the function handle in F.</p><h2 id="8">Remarks</h2><p>This function is unaffected by any type of white space.</p><p>This function is case sensitive</p><h2 id="9">Unit Tests</h2><p>Unlike ordinary Unit Tests, this is a list of tests. P means passing, U means unknown.</p><div><ul><li>P <code>'myFun'</code> -&gt; [{}, {}, @myFun]</li><li>P <code>'myFun;'</code> -&gt; [{}, {}, @myFun]</li><li>P <code>'myFun()'</code> -&gt; [{}, {}, @myFun]</li><li>P <code>'myFun();'</code> -&gt; [{}, {}, @myFun]</li><li>P <code>'myFun(in)'</code> -&gt; [{'in'}, {}, @myFun]</li><li>P <code>'myFun(in);'</code> -&gt; [{'in'}, {}, @myFun]</li><li>P <code>'myFun(in,in2)'</code> -&gt; [{'in', 'in2'}, {}, @myFun]</li><li>P <code>'myFun(in,In2);'</code> -&gt; [{'in', 'In2'}, {}, @myFun]</li><li>P <code>'[] = myFun'</code> -&gt; [{}, {}, @myFun]</li><li>P <code>'[] = myFun;'</code> -&gt; [{}, {}, @myFun]</li><li>P <code>'[] = myFun()'</code> -&gt; [{}, {}, @myFun]</li><li>P <code>'[] = myFun();'</code> -&gt; [{}, {}, @myFun]</li><li>P <code>'[] = myFun(in)'</code> -&gt; [{'in'}, {}, @myFun]</li><li>P <code>'[] = myFun(in);'</code> -&gt; [{'in'}, {}, @myFun]</li><li>P <code>'[] = myFun(in1,in2)'</code> -&gt; [{'in1', 'in2'}, {}, @myFun]</li><li>P <code>'[] = myFun(in1,in2);'</code> -&gt; [{'in1', 'in2'}, {}, @myFun]</li><li>P <code>'[a] = myFun'</code> -&gt; [{}, {'a'}, @myFun]</li><li>P <code>'[a] = myFun;'</code> -&gt; [{}, {'a'}, @myFun]</li><li>P <code>'[a] = myFun()'</code> -&gt; [{}, {'a'}, @myFun]</li><li>P <code>'[a] = myFun();'</code> -&gt; [{}, {'a'}, @myFun]</li><li>P <code>'[a] = myFun(in)'</code> -&gt; [{'in'}, {'a'}, @myFun]</li><li>P <code>'[a] = myFun(in);'</code> -&gt; [{'in'}, {'a'}, @myFun]</li><li>P <code>'[a] = myFun(in1,in2)'</code> -&gt; [{'in1', 'in2'}, {'a'}, @myFun]</li><li>P <code>'[a] = myFun(in1,in2);'</code> -&gt; [{'in1', 'in2'}, {'a'}, @myFun]</li><li>P <code>'a = myFun'</code> -&gt; [{}, {'a'}, @myFun]</li><li>P <code>'a = myFun;'</code> -&gt; [{}, {'a'}, @myFun]</li><li>P <code>'a = myFun()'</code> -&gt; [{}, {'a'}, @myFun]</li><li>P <code>'a = myFun();'</code> -&gt; [{}, {'a'}, @myFun]</li><li>P <code>'a = myFun(in)'</code> -&gt; [{'in'}, {'a'}, @myFun]</li><li>P <code>'a = myFun(in);'</code> -&gt; [{'in'}, {'a'}, @myFun]</li><li>P <code>'a = myFun(in1, in2)'</code> -&gt; [{'in1', 'in2'}, {'a'}, @myFun]</li><li>P <code>'a = myFun(in1, in2);'</code> -&gt; [{'in1', 'in2'}, {'a'}, @myFun]</li><li>P <code>'[a,b] = myFun'</code> -&gt; [{}, {'a', 'b'}, @myFun]</li><li>P <code>'[a,b] = myFun;'</code> -&gt; [{}, {'a', 'b'}, @myFun]</li><li>P <code>'[a,b] = myFun()'</code> -&gt; [{}, {'a', 'b'}, @myFun]</li><li>P <code>'[a,b] = myFun();'</code> -&gt; [{}, {'a', 'b'}, @myFun]</li><li>P <code>'[a,b] = myFun(in)'</code> -&gt; [{'in'}, {'a', 'b'}, @myFun]</li><li>P <code>'[a,b] = myFun(in);'</code> -&gt; [{'in'}, {'a', 'b'}, @myFun]</li><li>P <code>'[a,b] = myFun(in1, in2)'</code> -&gt; [{'in1', 'in2'}, {'a', 'b'}, @myFun]</li><li>P <code>'[a,b] = myFun(in1, in2);'</code> -&gt; [{'in1', 'in2'}, {'a', 'b'}, @myFun]</li></ul></div><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018a</a><br></p></div></div></body></html>